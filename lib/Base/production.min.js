!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["react-upload"]=t():e["react-upload"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/components/BaseUpload.js")}({"./src/components/BaseUpload.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n("babel-runtime/regenerator")),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("react"),u=l(i),s=n("./src/utils/index.js");function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}var f=function(e){function t(e){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleDeleted=function(e){a.setState({fileList:a.state.fileList.filter(function(t){return e.key!==t.key})})},a.handleSort=function(e,t){var n=Array.from(a.state.fileList),r=n[e];n[e]=n[t],n[t]=r,a.setState({fileList:n})},a.handleShowImage=function(e){var t=a.props.showImage;t&&t(e,a.state.fileList.map(function(e){return e.url}))},a.getHandles=function(){return{handleDeleted:a.handleDeleted,handleSort:a.handleSort,handleShowImage:a.handleShowImage}},a.handleOnChange=function(){var e=c(r.default.mark(function e(t){var o,i,u,l,f,p,d,h,g,v;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.props,i=o.uploadServerHost,u=o.dealResponse,l=o.getSignatureInfo,f=o.onChange,p=o.totalNum,d=o.showErrorMessage,h=a.state.fileList,!(t.length>p-h.length)){e.next=5;break}return d&&d("上传总数量超过限制了, 请重新选择"),e.abrupt("return");case 5:for(g=function(e){var o=t[e],p=URL.createObjectURL(o),d=document.createElement("img");d.onload=c(r.default.mark(function e(){var t,c,p,h,g;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.width,c=d.height,p={file:o,width:t,height:c},e.next=4,l(p);case 4:return h=e.sent,e.next=7,(0,s.xhrUpload)({file:o,uploadServerHost:i,signatureInfo:h});case 7:g=e.sent,a.setState({fileList:a.state.fileList.concat([Object.assign({},{name:o.name,size:o.size,type:o.type,webkitRelativePath:o.webkitRelativePath},u(g))])},function(){f&&f(a.state.fileList.map(function(e){return e.key}))});case 9:case"end":return e.stop()}},e,n)})),d.src=p},v=0;v<t.length;v++)g(v);case 7:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}(),a.onResize=function(e){a.setState({fileInput:{width:e.offsetWidth,height:e.offsetHeight}})},a.getRenderUploaded=function(){var e=a.props.UploadedImage,t=a.state.fileList;return t&&t.length&&e?u.default.createElement(e,o({fileList:t},a.props,{handles:a.getHandles()})):null},a.state={fileList:(0,s.getInitFileList)(e),fileInput:{width:0,height:0}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.totalNum,r=t.UploadButton,o=this.state,a=o.fileInput,i=o.fileList;return u.default.createElement("div",{className:"simple-upload-wrapper"},this.getRenderUploaded(),i.length<n?r?u.default.createElement(r,{onResize:this.onResize},u.default.createElement("input",{type:"file",accept:"image/*",multiple:n-i.length>1,onChange:function(t){e.handleOnChange(t.target.files)},style:{width:a.width,height:a.height,opacity:0,position:"absolute",top:0,left:0,zIndex:99,cursor:"pointer"}})):u.default.createElement("input",{type:"file",accept:"image/*",multiple:n-i.length>1,onChange:function(t){e.handleOnChange(t.target.files)}}):null)}}]),t}();f.defaultProps={uploadServerHost:"",downloadServerHost:"",thumbnail:"",totalNum:1,UploadedImage:null,UploadButton:null,value:[],dealResponse:function(e){return e},getSignatureInfo:function(){},onChange:function(){},showImage:function(){},showErrorMessage:function(e){console.warn(e)}},t.default=f},"./src/utils/getInitFileList.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.downloadServerHost;return Array.isArray(t)&&t.length?t.map(function(t){return{key:t,url:n+"/"+t,thumbnail:n+"/"+t+e.thumbnail}}):[]}},"./src/utils/httpFetch.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n("babel-runtime/regenerator"));t.default=function(e,t,n,o){var a="https://hp.bncry.cn/util/getAliyunSignature?"+["bizName=test","suffix="+e,"width="+t,"height="+n].join("&");return new Promise(function(e,t){fetch(a).then(function(){var t=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}(r.default.mark(function t(n){var o,a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:o=t.sent,a=o.data,e({key:a.dirPath,policy:a.policy,OSSAccessKeyId:a.OSSAccessKeyId,success_action_status:"200",callback:a.callback,signature:a.signature});case 5:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}())})}},"./src/utils/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitFileList=t.xhrUpload=t.httpFetch=void 0;var r=i(n("./src/utils/httpFetch.js")),o=i(n("./src/utils/xhrUpload.js")),a=i(n("./src/utils/getInitFileList.js"));function i(e){return e&&e.__esModule?e:{default:e}}t.httpFetch=r.default,t.xhrUpload=o.default,t.getInitFileList=a.default},"./src/utils/xhrUpload.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.file,n=e.uploadServerHost,r=e.signatureInfo;return new Promise(function(e,o){var a=new FormData;for(var i in r)a.append(i,r[i]);console.log(n),a.append("file",t);var u=new XMLHttpRequest;u.open("post",n,!0),u.onload=function(t){if(t&&t.target&&200===t.target.status)try{e(JSON.parse(t.target.response))}catch(e){o(t.target)}else o(t.target)},u.onerror=function(e){o(e.target)},u.upload.onprogress=function(e){console.log(e)},u.upload.onloadstart=function(){console.log("start")},u.send(a)})}},"babel-runtime/regenerator":function(e,t){e.exports=require("babel-runtime/regenerator")},react:function(e,t){e.exports=require("react")}})});
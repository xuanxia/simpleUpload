!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["react-upload"]=t():e["react-upload"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/components/ImageUpload.js")}({"./src/components/BaseUpload.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n("babel-runtime/regenerator")),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n("react"),u=c(i),l=n("./src/utils/index.js");function c(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}var f=function(e){function t(e){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.handleDeleted=function(e){console.log(e),o.setState({fileList:o.state.fileList.filter(function(t){return e.key!==t.key})})},o.handleSort=function(e,t){var n=Array.from(o.state.fileList),r=n[e];n[e]=n[t],n[t]=r,o.setState({fileList:n})},o.getHandles=function(){return{handleDeleted:o.handleDeleted,handleSort:o.handleSort}},o.handleOnChange=function(){var e=s(r.default.mark(function e(t){var a,i,u,c,f,p;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=o.props,i=a.uploadServerHost,u=a.dealResponse,c=a.getSignatureInfo,f=function(e){var a=t[e],f=URL.createObjectURL(a),p=document.createElement("img");p.onload=s(r.default.mark(function e(){var t,s,f,d,h;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.width,s=p.height,f={file:a,width:t,height:s},e.next=4,c(f).catch(function(){console.error("获取签名字段失败")});case 4:return d=e.sent,e.next=7,(0,l.xhrUpload)({file:a,uploadServerHost:i,signatureInfo:d});case 7:h=e.sent,o.setState({fileList:o.state.fileList.concat([Object.assign({},{name:a.name,size:a.size,type:a.type,webkitRelativePath:a.webkitRelativePath},u(h))])});case 9:case"end":return e.stop()}},e,n)})),p.src=f},p=0;p<t.length;p++)f(p);case 3:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}(),o.onResize=function(e){o.setState({fileInput:{width:e.offsetWidth,height:e.offsetHeight}})},o.state={fileList:(0,l.getInitFileList)(e),fileInput:{width:0,height:0}},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),a(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.multiple,r=t.UploadedImage,a=t.UploadButton,i=this.state,l=i.fileList,c=i.fileInput;return console.log(l),u.default.createElement("div",{className:"simple-upload-wrapper"},r&&u.default.createElement(r,o({fileList:l},this.props,{handles:this.getHandles()})),a?u.default.createElement(a,{onResize:this.onResize},u.default.createElement("input",{type:"file",accept:"image/*",multiple:n,onChange:function(t){console.log(t),console.log(t.target),console.log(t.target.files),e.handleOnChange(t.target.files)},style:{width:c.width,height:c.height,opacity:0,position:"absolute",top:0,left:0,zIndex:99,cursor:"pointer"}})):u.default.createElement("input",{type:"file",accept:"image/*",multiple:n,onChange:function(t){e.handleOnChange(t.target.files)}}))}}]),t}();f.defaultProps={uploadServerHost:"",downloadServerHost:"",thumbnail:"",multiple:!1,UploadedImage:null,UploadButton:null,value:[],dealResponse:function(e){return e},getSignatureInfo:function(){}},t.default=f},"./src/components/ImageUpload.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n("react"),a=l(o),i=l(n("./src/components/BaseUpload.js")),u=n("./src/defaultFunc/index.js");function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.PureComponent),r(t,[{key:"render",value:function(){var e=this.props,t=e.dealResponse,n=e.uploadServerHost,r=e.downloadServerHost,o=e.draggable,l=e.getSignatureInfo;return a.default.createElement(i.default,{multiple:!0,uploadServerHost:n,downloadServerHost:r,UploadedImage:o?u.DraggableUploadedImage:u.UploadedImage,UploadButton:u.UploadButton,dealResponse:t,getSignatureInfo:l})}}]),t}();t.default=c},"./src/defaultFunc/DraggableUploadedImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),u=n("react-beautiful-dnd");var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDragEnd=function(e){e.source&&e.destination&&n.props.handles.handleSort(e.source.index,e.destination.index)},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.fileList,n=e.handles;if(t&&t.length){var r=n.handleDeleted;return i.default.createElement(u.DragDropContext,{onDragEnd:this.onDragEnd},i.default.createElement(u.Droppable,{droppableId:"droppable",direction:"horizontal"},function(e,n){return i.default.createElement("div",o({style:(n.isDraggingOver,{background:"#fff",display:"inline-block",padding:0}),ref:e.innerRef},e.droppableProps),t.map(function(e,t){return i.default.createElement(u.Draggable,{key:e.key,draggableId:e.key,index:t,style:{display:"inline-block",position:"relative",marginRight:12}},function(t,n){return i.default.createElement("div",o({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{style:function(e,t){return o({display:"inline-block",marginRight:8,position:"relative",padding:0,userSelect:"none",background:"#fff"},t)}(n.isDragging,t.draggableProps.style)}),i.default.createElement("img",{width:100,height:100,src:""+e.url,alt:""}),i.default.createElement("a",{onClick:function(){r&&r(e)},style:{display:"inline-block",position:"absolute",fontSize:12,left:60,top:5,zIndex:10,color:"#fff",background:"#e2e2e2",padding:"2px 5px",cursor:"pointer"}},"删除"))})}))}))}}}]),t}();t.default=l},"./src/defaultFunc/UploadButton.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"componentDidMount",value:function(){(0,this.props.onResize)(this.refs.buttonWrapper)}},{key:"render",value:function(){return a.default.createElement("div",{ref:"buttonWrapper",style:{width:100,height:100,position:"relative",border:"1px solid #dbdbdb",fontSize:70,textAlign:"center",display:"inline-block",verticalAlign:"top",color:"rgb(128,134,139)"}},a.default.createElement("span",{style:{cursor:"pointer"}},"+"),this.props.children)}}]),t}();t.default=i},"./src/defaultFunc/UploadedImage.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);var i=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.fileList,n=e.handles;if(t&&t.length){var r=n.handleDeleted;return a.default.createElement("div",{style:{display:"inline-block"}},t.map(function(e){return a.default.createElement("div",{key:e.key,style:{display:"inline-block",position:"relative",marginRight:12}},a.default.createElement("img",{width:100,height:100,src:""+e.url,alt:""}),a.default.createElement("a",{onClick:function(){r&&r(e)},style:{display:"inline-block",position:"absolute",fontSize:12,left:60,top:5,zIndex:10,color:"#fff",background:"#e2e2e2",padding:"2px 5px",cursor:"pointer"}},"删除"))}))}}}]),t}();t.default=i},"./src/defaultFunc/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DraggableUploadedImage=t.UploadButton=t.UploadedImage=void 0;var r=i(n("./src/defaultFunc/UploadedImage.js")),o=i(n("./src/defaultFunc/UploadButton.js")),a=i(n("./src/defaultFunc/DraggableUploadedImage.js"));function i(e){return e&&e.__esModule?e:{default:e}}t.UploadedImage=r.default,t.UploadButton=o.default,t.DraggableUploadedImage=a.default},"./src/utils/getInitFileList.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.value,n=e.downloadServerHost;return Array.isArray(t)&&t.length?t.map(function(t){return{key:t,url:n+"/"+t,thumbnail:n+"/"+t+e.thumbnail}}):[]}},"./src/utils/httpFetch.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n("babel-runtime/regenerator"));t.default=function(e,t,n,o){var a="https://hp.bncry.cn/util/getAliyunSignature?"+["bizName=test","suffix="+e,"width="+t,"height="+n].join("&");return new Promise(function(e,t){fetch(a).then(function(){var t=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,a){try{var i=t[o](a),u=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}(r.default.mark(function t(n){var o,a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.json();case 2:o=t.sent,a=o.data,e({key:a.dirPath,policy:a.policy,OSSAccessKeyId:a.OSSAccessKeyId,success_action_status:"200",callback:a.callback,signature:a.signature});case 5:case"end":return t.stop()}},t,void 0)}));return function(e){return t.apply(this,arguments)}}())})}},"./src/utils/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInitFileList=t.xhrUpload=t.httpFetch=void 0;var r=i(n("./src/utils/httpFetch.js")),o=i(n("./src/utils/xhrUpload.js")),a=i(n("./src/utils/getInitFileList.js"));function i(e){return e&&e.__esModule?e:{default:e}}t.httpFetch=r.default,t.xhrUpload=o.default,t.getInitFileList=a.default},"./src/utils/xhrUpload.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.file,n=e.uploadServerHost,r=e.signatureInfo;return new Promise(function(e,o){var a=new FormData;for(var i in r)a.append(i,r[i]);console.log(n),a.append("file",t);var u=new XMLHttpRequest;u.open("post",n,!0),u.onload=function(t){if(t&&t.target&&200===t.target.status)try{e(JSON.parse(t.target.response))}catch(e){o(t.target)}else o(t.target)},u.onerror=function(e){o(e.target)},u.upload.onprogress=function(e){console.log(e)},u.upload.onloadstart=function(){console.log("start")},u.send(a)})}},"babel-runtime/regenerator":function(e,t){e.exports=require("babel-runtime/regenerator")},react:function(e,t){e.exports=require("react")},"react-beautiful-dnd":function(e,t){e.exports=require("react-beautiful-dnd")}})});